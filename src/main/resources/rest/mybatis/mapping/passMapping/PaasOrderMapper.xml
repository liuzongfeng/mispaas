<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="rest.mybatis.dao.passDao.PaasOrderMapper" >
  <resultMap id="BaseResultMap" type="rest.mybatis.model.passModel.PaasOrder" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Mon May 08 16:50:01 CST 2017.
    -->
    <id column="ID" property="id" jdbcType="INTEGER" />
    <result column="BILL_NO" property="billNo" jdbcType="VARCHAR" />
    <result column="PRO_ID" property="proId" jdbcType="INTEGER" />
    <result column="TENANT_ID" property="tenantId" jdbcType="INTEGER" />
    <result column="STATUS" property="status" jdbcType="INTEGER" />
    <result column="CRATE_DATE" property="crateDate" jdbcType="TIMESTAMP" />
    <result column="APPROVE_ID" property="approveId" jdbcType="VARCHAR" />
    <result column="APPROVE_DATE" property="approveDate" jdbcType="TIMESTAMP" />
    <result column="APPROVE_DESCIBE" property="approveDescibe" jdbcType="VARCHAR" />
    <result column="INSTANCE_ID" property="instanceId" jdbcType="VARCHAR" />
    <association property="paasInstance"
		javaType="rest.mybatis.model.passModel.PaasInstance">
		<id column="INSTANCE_ID" property="instanceId" jdbcType="VARCHAR" />
		<result column="TEMPLATE_ID" property="templateId" jdbcType="INTEGER" />
		<result column="INSTANCE_NAME" property="instanceName"
			jdbcType="VARCHAR" />
		<result column="INSTANCE_STATUS" property="instanceStatus"
			jdbcType="INTEGER" />
		<result column="ACCESS_KEY" property="accessKey" jdbcType="VARCHAR" />
		<result column="PUB_DNS" property="pubDns" jdbcType="VARCHAR" />
		<result column="URL_PREFIX" property="urlPrefix" jdbcType="VARCHAR" />
		<result column="ORDER_ID" property="orderId" jdbcType="INTEGER" />
		  <result column="VERSION" property="version" jdbcType="VARCHAR" />
	</association>
	
	<association property="paasTemplate"
		javaType="rest.mybatis.model.passModel.PaasTemplate">
		 <id column="ID" property="id" jdbcType="INTEGER" />
    <result column="TEMPLATE_ID" property="templateId" jdbcType="VARCHAR" />
    <result column="VERSION" property="version" jdbcType="VARCHAR" />
    <result column="TEMPLATE_NAME" property="templateName" jdbcType="VARCHAR" />
    <result column="TEMPLATE_TYPE" property="templateType" jdbcType="VARCHAR" />
    <result column="TEMPLATE_CATEGORY" property="templateCategory" jdbcType="VARCHAR" />
    <result column="USER_MODE" property="userMode" jdbcType="VARCHAR" />
    <result column="PRICE" property="price" jdbcType="DOUBLE" />
    <result column="IS_PUB" property="isPub" jdbcType="INTEGER" />
    <result column="UPLOADPERSON" property="uploadPerson" jdbcType="VARCHAR" />
    <result column="UPLOADDATE" property="uploadDate" jdbcType="DATE" />
    <result column="PRODUCT_NAME" property="productName" jdbcType="VARCHAR" />
	</association>
	<collection property="paasSubservices" column="PRO_ID" ofType="rest.mybatis.model.passModel.PaasSubservice" select="selectSubserviceBytempleteId"></collection>
  </resultMap>
  
  <resultMap id="instanceResultMap" type="rest.mybatis.model.passModel.PaasOrder" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Mon May 08 16:50:01 CST 2017.
    -->
    <id column="ID" property="id" jdbcType="INTEGER" />
    <result column="BILL_NO" property="billNo" jdbcType="VARCHAR" />
    <result column="PRO_ID" property="proId" jdbcType="INTEGER" />
    <result column="TENANT_ID" property="tenantId" jdbcType="INTEGER" />
    <result column="STATUS" property="status" jdbcType="INTEGER" />
    <result column="CRATE_DATE" property="crateDate" jdbcType="TIMESTAMP" />
    <result column="APPROVE_ID" property="approveId" jdbcType="VARCHAR" />
    <result column="APPROVE_DATE" property="approveDate" jdbcType="TIMESTAMP" />
    <result column="APPROVE_DESCIBE" property="approveDescibe" jdbcType="VARCHAR" />
    <result column="INSTANCE_ID" property="instanceId" jdbcType="VARCHAR" />
  </resultMap>
  <sql id="Base_Column_List" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Mon May 08 16:50:01 CST 2017.
    -->
    ID, BILL_NO, PRO_ID, TENANT_ID, STATUS, CRATE_DATE, APPROVE_ID, APPROVE_DATE, APPROVE_DESCIBE,INSTANCE_ID
  </sql>
  <select id="selectByPrimaryKey" resultMap="BaseResultMap" parameterType="java.lang.Integer" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Mon May 08 16:50:01 CST 2017.
    -->
    select 
    <include refid="Base_Column_List" />
    from PAAS_ORDER
    where ID = #{id,jdbcType=INTEGER}
  </select>
  
  <!-- 根据实例id查询订单 -->
  <select id="selectByInstanceId" resultType="java.lang.Integer" parameterType="java.lang.String" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Mon May 08 16:50:01 CST 2017.
    -->
    select 
    ID
    from PAAS_ORDER
    where INSTANCE_ID = #{instanceId,jdbcType=VARCHAR}
  </select>
  <!-- 复合详情查询 -->
  <select id="selectByPrimaryId" resultMap="BaseResultMap" parameterType="java.lang.Integer" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Mon May 08 16:50:01 CST 2017.
    -->
    select
		 po.ID, BILL_NO, PRO_ID, TENANT_ID, STATUS, CRATE_DATE, APPROVE_ID, APPROVE_DATE, APPROVE_DESCIBE,po.INSTANCE_ID,
		 pi.INSTANCE_ID, pi.TEMPLATE_ID, INSTANCE_NAME, INSTANCE_STATUS, ACCESS_KEY, PUB_DNS, URL_PREFIX,
		 ORDER_ID,pi.VERSION,
		 pt.ID, pt.TEMPLATE_ID, pt.VERSION, TEMPLATE_TYPE, TEMPLATE_CATEGORY, USER_MODE, PRICE, IS_PUB,PRODUCT_NAME
		from PAAS_ORDER po
		LEFT  join PAAS_INSTANCE pi on po.INSTANCE_ID=pi.INSTANCE_ID
		LEFT join PAAS_TEMPLATE pt on PRO_ID=pt.ID
    where po.ID = #{orderId,jdbcType=INTEGER}
  </select>
   <!-- 子查询模块列表 -->
  <select id="selectSubserviceBytempleteId" parameterType="java.lang.Integer" resultMap="rest.mybatis.dao.passDao.PaasSubserviceMapper.BaseResultMap">
  	  select ID, TEMPLATE_ID, MODULE_NAME, MODULE_URL, MODULE_IS_DIS, MODULE_DES, MODULE_IMG_NAME
  	   from PAAS_SUBSERVICE
  	   where TEMPLATE_ID=#{ID}
  </select>
  <!-- 查询购买应用By符合条件 -->
	<select id="selectByCondition" resultMap="BaseResultMap">
		<bind name="offset" value="(page-1)*counm"/>
		<!-- WARNING - @mbggenerated This element is automatically generated by 
			MyBatis Generator, do not modify. This element was generated on Mon May 08 
			16:50:01 CST 2017. -->
		select
		 po.ID, BILL_NO, PRO_ID, TENANT_ID, STATUS, CRATE_DATE, APPROVE_ID, APPROVE_DATE, APPROVE_DESCIBE,po.INSTANCE_ID,
		 pi.INSTANCE_ID, pi.TEMPLATE_ID, INSTANCE_NAME, INSTANCE_STATUS, ACCESS_KEY, PUB_DNS, URL_PREFIX,
		 ORDER_ID,pi.VERSION,
		 pt.ID, pt.TEMPLATE_ID, pt.VERSION, TEMPLATE_TYPE, TEMPLATE_CATEGORY, USER_MODE, PRICE, IS_PUB,PRODUCT_NAME
		from PAAS_ORDER po
		LEFT  join PAAS_INSTANCE pi on po.INSTANCE_ID=pi.INSTANCE_ID
		LEFT join PAAS_TEMPLATE pt on PRO_ID=pt.ID
		<where>   <!-- 拼接where后查询条件，如果第一个条件以and|or开头 会自动去掉 -->
				TENANT_ID = #{tenantId}
				and STATUS !=3
			<if test="templateCategory!=null and templateCategory!=''">
				and TEMPLATE_CATEGORY = #{templateCategory}
			</if>
		</where>
		order by po.ID desc
		limit ${offset},${counm} 
	</select>
	<!-- 复合产品名称模糊查询 -->
		<select id="selectByInstanceName" resultMap="BaseResultMap">
		<bind name="offset" value="(page-1)*counm"/>
		<!-- WARNING - @mbggenerated This element is automatically generated by 
			MyBatis Generator, do not modify. This element was generated on Mon May 08 
			16:50:01 CST 2017. -->
		select
		 po.ID, BILL_NO, PRO_ID, TENANT_ID, STATUS, CRATE_DATE, APPROVE_ID, APPROVE_DATE, APPROVE_DESCIBE,po.INSTANCE_ID,
		 pi.INSTANCE_ID, pi.TEMPLATE_ID, INSTANCE_NAME, INSTANCE_STATUS, ACCESS_KEY, PUB_DNS, URL_PREFIX,
		 ORDER_ID,pi.VERSION,
		 pt.ID, pt.TEMPLATE_ID, pt.VERSION, TEMPLATE_TYPE, TEMPLATE_CATEGORY, USER_MODE, PRICE, IS_PUB,PRODUCT_NAME
		from PAAS_ORDER po
		LEFT  join PAAS_INSTANCE pi on po.INSTANCE_ID=pi.INSTANCE_ID
		LEFT join PAAS_TEMPLATE pt on PRO_ID=pt.ID
		<where>   <!-- 拼接where后查询条件，如果第一个条件以and|or开头 会自动去掉 -->
				TENANT_ID = #{tenantId}
				and STATUS !=3 and STATUS !=1
			<if test="instanceName!=null and instanceName!=''">
				   and PRODUCT_NAME like '%${instanceName}%'
			</if>
			<if test="templateCategory!=null and templateCategory!=''">
				and TEMPLATE_CATEGORY = #{templateCategory}
			</if>
		</where>
		UNION
		select
		 po.ID, BILL_NO, PRO_ID, TENANT_ID, STATUS, CRATE_DATE, APPROVE_ID, APPROVE_DATE, APPROVE_DESCIBE,po.INSTANCE_ID,
		 pi.INSTANCE_ID, pi.TEMPLATE_ID, INSTANCE_NAME, INSTANCE_STATUS, ACCESS_KEY, PUB_DNS, URL_PREFIX,
		 ORDER_ID,pi.VERSION,
		 pt.ID, pt.TEMPLATE_ID, pt.VERSION, TEMPLATE_TYPE, TEMPLATE_CATEGORY, USER_MODE, PRICE, IS_PUB,PRODUCT_NAME
		from PAAS_ORDER po
		LEFT  join PAAS_INSTANCE pi on po.INSTANCE_ID=pi.INSTANCE_ID
		LEFT join PAAS_TEMPLATE pt on PRO_ID=pt.ID
		<where>   <!-- 拼接where后查询条件，如果第一个条件以and|or开头 会自动去掉 -->
				TENANT_ID = #{tenantId}
				and STATUS=1 and INSTANCE_STATUS=1
			<if test="instanceName!=null and instanceName!=''">
					and INSTANCE_NAME like '%${instanceName}%'
			</if>
			<if test="templateCategory!=null and templateCategory!=''">
				and TEMPLATE_CATEGORY = #{templateCategory}
			</if>
		</where>
		UNION
		select
		 po.ID, BILL_NO, PRO_ID, TENANT_ID, STATUS, CRATE_DATE, APPROVE_ID, APPROVE_DATE, APPROVE_DESCIBE,po.INSTANCE_ID,
		 pi.INSTANCE_ID, pi.TEMPLATE_ID, INSTANCE_NAME, INSTANCE_STATUS, ACCESS_KEY, PUB_DNS, URL_PREFIX,
		 ORDER_ID,pi.VERSION,
		 pt.ID, pt.TEMPLATE_ID, pt.VERSION, TEMPLATE_TYPE, TEMPLATE_CATEGORY, USER_MODE, PRICE, IS_PUB,PRODUCT_NAME
		from PAAS_ORDER po
		LEFT  join PAAS_INSTANCE pi on po.INSTANCE_ID=pi.INSTANCE_ID
		LEFT join PAAS_TEMPLATE pt on PRO_ID=pt.ID
		<where>   <!-- 拼接where后查询条件，如果第一个条件以and|or开头 会自动去掉 -->
				TENANT_ID = #{tenantId}
				and STATUS=1  and INSTANCE_STATUS !=1
			<if test="instanceName!=null and instanceName!=''">
				   and PRODUCT_NAME like '%${instanceName}%'
			</if>
			<if test="templateCategory!=null and templateCategory!=''">
				and TEMPLATE_CATEGORY = #{templateCategory}
			</if>
		</where>
		order by CRATE_DATE desc
		limit ${offset},${counm} 
	</select>
	<!-- UUID查询订单 -->
	 <select id="selectByUUID" resultMap="BaseResultMap" parameterType="java.lang.String" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Mon May 08 16:50:01 CST 2017.
    -->
    select 
    <include refid="Base_Column_List" />
    from PAAS_ORDER
    where BILL_NO = #{uuid,jdbcType=INTEGER}
  </select>
  <!-- 数据条数 -->
   <select id="selectOrderCount" resultType="java.lang.Integer" parameterType="java.lang.String" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Mon May 08 16:50:01 CST 2017.
    -->
    select 
    count(*)
    from PAAS_ORDER
    where TENANT_ID = #{tenantId} and STATUS !=3
  </select>
  
  <!-- 条件查询数据条数 -->
<select id="selectOrderCountBycondition" resultType="java.lang.Integer" >
    
		select
		 po.ID, BILL_NO, PRO_ID, TENANT_ID, STATUS, CRATE_DATE, APPROVE_ID, APPROVE_DATE, APPROVE_DESCIBE,po.INSTANCE_ID,
		 pi.INSTANCE_ID, pi.TEMPLATE_ID, INSTANCE_NAME, INSTANCE_STATUS, ACCESS_KEY, PUB_DNS, URL_PREFIX,
		 ORDER_ID,pi.VERSION,
		 pt.ID, pt.TEMPLATE_ID, pt.VERSION, TEMPLATE_TYPE, TEMPLATE_CATEGORY, USER_MODE, PRICE, IS_PUB,PRODUCT_NAME
		from PAAS_ORDER po
		LEFT  join PAAS_INSTANCE pi on po.INSTANCE_ID=pi.INSTANCE_ID
		LEFT join PAAS_TEMPLATE pt on PRO_ID=pt.ID
		<where>   <!-- 拼接where后查询条件，如果第一个条件以and|or开头 会自动去掉 -->
				TENANT_ID = #{tenantId}
				and STATUS !=3 and STATUS !=1
			<if test="instanceName!=null and instanceName!=''">
				   and PRODUCT_NAME like '%${instanceName}%'
			</if>
			<if test="templateCategory!=null and templateCategory!=''">
				and TEMPLATE_CATEGORY = #{templateCategory}
			</if>
		</where>
		UNION
		select
		 po.ID, BILL_NO, PRO_ID, TENANT_ID, STATUS, CRATE_DATE, APPROVE_ID, APPROVE_DATE, APPROVE_DESCIBE,po.INSTANCE_ID,
		 pi.INSTANCE_ID, pi.TEMPLATE_ID, INSTANCE_NAME, INSTANCE_STATUS, ACCESS_KEY, PUB_DNS, URL_PREFIX,
		 ORDER_ID,pi.VERSION,
		 pt.ID, pt.TEMPLATE_ID, pt.VERSION, TEMPLATE_TYPE, TEMPLATE_CATEGORY, USER_MODE, PRICE, IS_PUB,PRODUCT_NAME
		from PAAS_ORDER po
		LEFT  join PAAS_INSTANCE pi on po.INSTANCE_ID=pi.INSTANCE_ID
		LEFT join PAAS_TEMPLATE pt on PRO_ID=pt.ID
		<where>   <!-- 拼接where后查询条件，如果第一个条件以and|or开头 会自动去掉 -->
				TENANT_ID = #{tenantId}
				and STATUS=1 and INSTANCE_STATUS=1
			<if test="instanceName!=null and instanceName!=''">
					and INSTANCE_NAME like '%${instanceName}%'
			</if>
			<if test="templateCategory!=null and templateCategory!=''">
				and TEMPLATE_CATEGORY = #{templateCategory}
			</if>
		</where>
		UNION
		select
		 po.ID, BILL_NO, PRO_ID, TENANT_ID, STATUS, CRATE_DATE, APPROVE_ID, APPROVE_DATE, APPROVE_DESCIBE,po.INSTANCE_ID,
		 pi.INSTANCE_ID, pi.TEMPLATE_ID, INSTANCE_NAME, INSTANCE_STATUS, ACCESS_KEY, PUB_DNS, URL_PREFIX,
		 ORDER_ID,pi.VERSION,
		 pt.ID, pt.TEMPLATE_ID, pt.VERSION, TEMPLATE_TYPE, TEMPLATE_CATEGORY, USER_MODE, PRICE, IS_PUB,PRODUCT_NAME
		from PAAS_ORDER po
		LEFT  join PAAS_INSTANCE pi on po.INSTANCE_ID=pi.INSTANCE_ID
		LEFT join PAAS_TEMPLATE pt on PRO_ID=pt.ID
		<where>   <!-- 拼接where后查询条件，如果第一个条件以and|or开头 会自动去掉 -->
				TENANT_ID = #{tenantId}
				and STATUS=1  and INSTANCE_STATUS !=1
			<if test="instanceName!=null and instanceName!=''">
				   and PRODUCT_NAME like '%${instanceName}%'
			</if>
			<if test="templateCategory!=null and templateCategory!=''">
				and TEMPLATE_CATEGORY = #{templateCategory}
			</if>
		</where>
  </select>
  <delete id="deleteByPrimaryKey" parameterType="java.lang.Integer" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Mon May 08 16:50:01 CST 2017.
    -->
    delete from PAAS_ORDER
    where ID = #{id,jdbcType=INTEGER}
  </delete>
  <insert id="insert" parameterType="rest.mybatis.model.passModel.PaasOrder" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Mon May 08 16:50:01 CST 2017.
    -->
    insert into PAAS_ORDER (ID, BILL_NO, PRO_ID, 
      TENANT_ID, STATUS, CRATE_DATE, 
      APPROVE_ID, APPROVE_DATE, APPROVE_DESCIBE,INSTANCE_ID
      )
    values (#{id,jdbcType=INTEGER}, #{billNo,jdbcType=VARCHAR}, #{proId,jdbcType=INTEGER}, 
      #{tenantId,jdbcType=INTEGER}, #{status,jdbcType=INTEGER}, #{crateDate,jdbcType=TIMESTAMP}, 
      #{approveId,jdbcType=INTEGER}, #{approveDate,jdbcType=TIMESTAMP}, #{approveDescibe,jdbcType=VARCHAR},#{instanceId,jdbcType=VARCHAR}
      )
  </insert>
  <insert id="insertSelective" parameterType="rest.mybatis.model.passModel.PaasOrder" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Mon May 08 16:50:01 CST 2017.
    -->
    insert into PAAS_ORDER
    <trim prefix="(" suffix=")" suffixOverrides="," >
      <if test="id != null" >
        ID,
      </if>
      <if test="billNo != null" >
        BILL_NO,
      </if>
      <if test="proId != null" >
        PRO_ID,
      </if>
      <if test="tenantId != null" >
        TENANT_ID,
      </if>
      <if test="status != null" >
        STATUS,
      </if>
      <if test="crateDate != null" >
        CRATE_DATE,
      </if>
      <if test="approveId != null" >
        APPROVE_ID,
      </if>
      <if test="approveDate != null" >
        APPROVE_DATE,
      </if>
      <if test="approveDescibe != null" >
        APPROVE_DESCIBE,
      </if>
      <if test="approveDescibe != null" >
       INSTANCE_ID,
      </if>
    </trim>
    <trim prefix="values (" suffix=")" suffixOverrides="," >
      <if test="id != null" >
        #{id,jdbcType=INTEGER},
      </if>
      <if test="billNo != null" >
        #{billNo,jdbcType=VARCHAR},
      </if>
      <if test="proId != null" >
        #{proId,jdbcType=INTEGER},
      </if>
      <if test="tenantId != null" >
        #{tenantId,jdbcType=INTEGER},
      </if>
      <if test="status != null" >
        #{status,jdbcType=INTEGER},
      </if>
      <if test="crateDate != null" >
        #{crateDate,jdbcType=TIMESTAMP},
      </if>
      <if test="approveId != null" >
        #{approveId,jdbcType=INTEGER},
      </if>
      <if test="approveDate != null" >
        #{approveDate,jdbcType=TIMESTAMP},
      </if>
      <if test="approveDescibe != null" >
        #{approveDescibe,jdbcType=VARCHAR},
      </if>
       <if test="approveDescibe != null" >
        #{instanceId,jdbcType=VARCHAR},
      </if>
    </trim>
  </insert>
  <update id="updateByPrimaryKeySelective" parameterType="rest.mybatis.model.passModel.PaasOrder" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Mon May 08 16:50:01 CST 2017.
    -->
    update PAAS_ORDER
    <set >
      <if test="billNo != null" >
        BILL_NO = #{billNo,jdbcType=VARCHAR},
      </if>
      <if test="proId != null" >
        PRO_ID = #{proId,jdbcType=INTEGER},
      </if>
      <if test="tenantId != null" >
        TENANT_ID = #{tenantId,jdbcType=INTEGER},
      </if>
      <if test="status != null" >
        STATUS = #{status,jdbcType=INTEGER},
      </if>
      <if test="crateDate != null" >
        CRATE_DATE = #{crateDate,jdbcType=TIMESTAMP},
      </if>
      <if test="approveId != null" >
        APPROVE_ID = #{approveId,jdbcType=INTEGER},
      </if>
      <if test="approveDate != null" >
        APPROVE_DATE = #{approveDate,jdbcType=TIMESTAMP},
      </if>
      <if test="approveDescibe != null" >
        APPROVE_DESCIBE = #{approveDescibe,jdbcType=VARCHAR},
      </if>
      <if test="approveDescibe != null" >
        INSTANCE_ID = #{instanceId,jdbcType=VARCHAR},
      </if>
    </set>
    where ID = #{id,jdbcType=INTEGER}
  </update>
  <update id="updateByPrimaryKey" parameterType="rest.mybatis.model.passModel.PaasOrder" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Mon May 08 16:50:01 CST 2017.
    -->
    update PAAS_ORDER
    set BILL_NO = #{billNo,jdbcType=VARCHAR},
      PRO_ID = #{proId,jdbcType=INTEGER},
      TENANT_ID = #{tenantId,jdbcType=INTEGER},
      STATUS = #{status,jdbcType=INTEGER},
      CRATE_DATE = #{crateDate,jdbcType=TIMESTAMP},
      APPROVE_ID = #{approveId,jdbcType=INTEGER},
      APPROVE_DATE = #{approveDate,jdbcType=TIMESTAMP},
      APPROVE_DESCIBE = #{approveDescibe,jdbcType=VARCHAR},
       INSTANCE_ID = #{instanceId,jdbcType=VARCHAR}
    where ID = #{id,jdbcType=INTEGER}
  </update>
  
  <select id="selectPaasOrderByCondit" resultType="java.lang.Integer" parameterType="rest.mybatis.model.passModel.PaasOrder">
  	select count(id) from PAAS_ORDER
  	where 1=1 
  	<if test="tenantId != null and tenantId != ''">
  		and TENANT_ID=#{tenantId,jdbcType=INTEGER}
  	</if>
  	<if test="status != null">
  		and STATUS=#{status,jdbcType=INTEGER}
  	</if>
  	<if test="startDate != null and startDate != ''">
  		and DATE_FORMAT(CRATE_DATE,'%Y-%m-%d') <![CDATA[>=]]> #{startDate,jdbcType=DATE}
  	</if>
  	<if test="endDate != null and endDate != ''">
  		and DATE_FORMAT(CRATE_DATE,'%Y-%m-%d') <![CDATA[<=]]> #{endDate,jdbcType=DATE}
  	</if>
  </select>
  
  <select id="selectPaasOrderObjByCondit" resultMap="BaseResultMap" parameterType="rest.page.util.Pageinfo">
  	select
  	a.ID, a.BILL_NO, a.PRO_ID, a.TENANT_ID, a.STATUS, a.CRATE_DATE, a.APPROVE_ID, 
  	a.APPROVE_DATE, a.APPROVE_DESCIBE, a.INSTANCE_ID, b.TEMPLATE_NAME
  	from PAAS_ORDER a
  	left join PAAS_TEMPLATE b on a.PRO_ID=b.ID
  	where 1=1 
  	<if test="ConditionObj.tenantId != null and ConditionObj.tenantId != ''">
  		and a.TENANT_ID=#{ConditionObj.tenantId,jdbcType=INTEGER}
  	</if>
  	<if test="ConditionObj.status != null">
  		and a.STATUS=#{ConditionObj.status,jdbcType=VARCHAR}
  	</if>
  	<if test="ConditionObj.startDate != null and ConditionObj.startDate != ''">
  		and DATE_FORMAT(CRATE_DATE,'%Y-%m-%d') <![CDATA[>=]]> #{ConditionObj.startDate,jdbcType=DATE}
  	</if>
  	<if test="ConditionObj.endDate != null and ConditionObj.endDate != ''">
  		and DATE_FORMAT(CRATE_DATE,'%Y-%m-%d') <![CDATA[<=]]> #{ConditionObj.endDate,jdbcType=DATE}
  	</if>
  	order by a.CRATE_DATE DESC
  	limit #{begin},#{shownum}
  </select>
  <update id="updateOrderStatue" parameterType="rest.mybatis.model.passModel.PaasOrder">
  	update PAAS_ORDER
  	<set >
      <if test="billNo != null" >
        BILL_NO = #{billNo,jdbcType=VARCHAR},
      </if>
      <if test="proId != null" >
        PRO_ID = #{proId,jdbcType=INTEGER},
      </if>
      <if test="tenantId != null" >
        TENANT_ID = #{tenantId,jdbcType=INTEGER},
      </if>
      <if test="status != null" >
        STATUS = #{status,jdbcType=INTEGER},
      </if>
      <if test="crateDate != null" >
        CRATE_DATE = #{crateDate,jdbcType=TIMESTAMP},
      </if>
      <if test="approveId != null" >
        APPROVE_ID = #{approveId,jdbcType=INTEGER},
      </if>
      <if test="approveDate != null" >
        APPROVE_DATE = #{approveDate,jdbcType=TIMESTAMP},
      </if>
      <if test="approveDescibe != null" >
        APPROVE_DESCIBE = #{approveDescibe,jdbcType=VARCHAR},
      </if>
      <if test="approveDescibe != null" >
        INSTANCE_ID = #{instanceId,jdbcType=VARCHAR},
      </if>
    </set>
    where ID = #{id,jdbcType=INTEGER}
  </update>
  
  <select id="selectOrderbyorgid" parameterType="java.lang.String" resultMap="instanceResultMap">
  	select distinct b.*
	from PAAS_ORD_TENANT_ORG_R a
	left join PAAS_ORDER b on a.ORD_ID=b.ID
	where 1=1 and b.STATUS=1 and a.ORG_ID=#{orgid}
  </select>
  
   <select id="selectOrderandInsbyorgid" parameterType="java.util.Map" resultMap="instanceResultMap">
	  	select distinct b.*
		from PAAS_ORD_TENANT_ORG_R a
		left join PAAS_ORDER b on a.ORD_ID=b.ID
		left join PAAS_SUBSERVICE c on b.PRO_ID=c.TEMPLATE_ID
		where 1=1 and b.STATUS=1 and a.ORG_ID=#{orgid}
		and c.MODULE_URL=#{url}
  </select>
  
  <select id="selectOrderbyBillNo" parameterMap="java.lang.String" resultMap="instanceResultMap">
  		select <include refid="Base_Column_List" />
  		from PAAS_ORDER where BILL_NO=#{orderid}
  </select>
</mapper>